# 🎯 ホバー+キー ショートカット - テスト手順

## ✅ 実現した機能

- ✅ 関数の**1行上**にマウスホバーでショートカット一覧を表示
- ✅ ホバー中にキーを押すと**文字入力を防いで**アクションを実行
- ✅ ステータスバーでホバー状態を通知
- ✅ 2秒間のタイムアウト（マウスが離れても一定時間有効）

---

## 🚀 準備

```bash
# コンパイル
npm run compile

# VS Codeで開く
code .

# F5キーで起動
```

---

## 🧪 テスト1: 基本的なホバー+キー

### 手順

1. 拡張機能開発ホストで `test-samples/sample.js` を開く

2. 以下のコードを見つける:
```javascript
3 | // ========================================
4 | // テスト1: 関数宣言
5 | function myTestFunction() {
6 |     console.log('Hello, Ghost in the VSC!');
```

3. **4行目（コメント行）にマウスをホバー**
   - 重要: 関数の1行上の行にホバーしてください

### 期待される結果

**ホバー情報が表示される:**

```
┌─────────────────────────────────────┐
│ 👻 Ghost in the VSC                │
│                                     │
│ myTestFunction (function)           │
│ ─────────────────────────────────   │
│ キーを押してショートカット実行:      │
│                                     │
│ • D: 定義へジャンプ (F12)           │
│ • R: 参照を表示 (Shift+F12)        │
│ • H: 呼び出し階層 (Shift+Alt+H)    │
│ • N: 名前を変更 (F2)               │
│ • P: 定義をプレビュー (Alt+F12)    │
│ • C: コメントを追加                 │
│ ─────────────────────────────────   │
│ ホバー中です。キーを押すと          │
│ 即座に実行されます。                │
└─────────────────────────────────────┘
```

**ステータスバー（画面下部）に表示:**
```
👻 "myTestFunction" (function) - ホバー中
```

✅ **合格** / ❌ **不合格**

---

## 🧪 テスト2: キー入力でアクション実行

### 手順

1. テスト1の状態から続行（ホバー情報が表示されている）
2. **Dキー**を押す

### 期待される結果

- ✅ 「定義へジャンプ」が実行される
- ✅ カーソルが関数定義の位置に移動
- ✅ 通知が表示される: `✅ myTestFunction: 定義へジャンプ`
- ✅ ホバー情報が消える
- ✅ ステータスバーの通知が消える
- ✅ **重要**: エディタに「D」という文字が入力されていない

✅ **合格** / ❌ **不合格**

---

## 🧪 テスト3: 参照を表示（Rキー）

### 手順

1. 4行目（コメント行）にマウスホバー
2. ホバー情報が表示される
3. **Rキー**を押す

### 期待される結果

- ✅ 参照パネルが開く
- ✅ `myTestFunction` の使用箇所が一覧表示される
- ✅ 通知が表示される: `✅ myTestFunction: 参照を表示`
- ✅ エディタに「R」という文字が入力されていない

✅ **合格** / ❌ **不合格**

---

## 🧪 テスト4: コメント追加（Cキー）

### 手順

1. 4行目にホバー
2. **Cキー**を押す

### 期待される結果

**関数の上にJSDocコメントが挿入される:**

```javascript
3 | // ========================================
4 | // テスト1: 関数宣言
5 | /**
6 |  * myTestFunction の説明
7 |  */
8 | function myTestFunction() {
```

- ✅ コメントが挿入される
- ✅ カーソルが「説明」の部分に移動
- ✅ そのまま説明文を入力できる
- ✅ エディタに「C」という文字が入力されていない

✅ **合格** / ❌ **不合格**

**注意**: このテストを実行すると実際にコメントが挿入されます。
元に戻すには `Ctrl+Z` を押してください。

---

## 🧪 テスト5: 変数でのテスト

### 手順

1. 以下のコードを見つける:
```javascript
12 | // テスト3: 変数宣言
13 | const myVariable = 42;
```

2. **12行目（コメント行）にホバー**
3. ホバー情報を確認

### 期待される結果

**コンテキストが「variable」:**

```
👻 Ghost in the VSC

myVariable (variable)
───────────────────────
キーを押してショートカット実行:

• D: 定義へジャンプ
• R: 参照を表示
• N: 名前を変更
• T: 型定義へジャンプ
```

4. **Nキー**を押す

### 期待される結果

- ✅ リネームモードになる
- ✅ `myVariable` がハイライトされる
- ✅ すべての参照箇所がハイライトされる
- ✅ エディタに「N」という文字が入力されていない

✅ **合格** / ❌ **不合格**

---

## 🧪 テスト6: クラスでのテスト

### 手順

1. 以下のコードを見つける:
```javascript
21 | // テスト4: クラスとメソッド
22 | class MyTestClass {
```

2. **21行目にホバー**
3. ホバー情報を確認

### 期待される結果

**コンテキストが「class」:**

```
👻 Ghost in the VSC

MyTestClass (class)
───────────────────────
• D: 定義へジャンプ
• R: 参照を表示
• I: 実装へジャンプ
• N: 名前を変更
• M: メンバー一覧
```

✅ **合格** / ❌ **不合格**

---

## 🧪 テスト7: タイムアウトの確認

### 手順

1. 4行目にホバー
2. ホバー情報が表示される
3. マウスを動かさずに**3秒待つ**
4. **Dキー**を押す

### 期待される結果（2つのケース）

**ケースA: 2秒以内にキーを押した場合**
- ✅ アクションが実行される
- ✅ 文字入力されない

**ケースB: 2秒以上経過してからキーを押した場合**
- ✅ アクションは実行されない
- ✅ 「D」という文字が通常通り入力される
- ✅ ステータスバーの通知が消えている

✅ **合格** / ❌ **不合格**

---

## 🧪 テスト8: 非ショートカットキーの入力

### 手順

1. 4行目にホバー
2. ホバー情報が表示される
3. **Aキー**を押す（ショートカットに含まれていないキー）

### 期待される結果

- ✅ アクションは実行されない
- ✅ 「A」という文字が通常通り入力される
- ✅ ホバー状態は継続（ステータスバーの通知が残る）

✅ **合格** / ❌ **不合格**

---

## 🧪 テスト9: QuickPickとの併用

ホバー+キーとQuickPickの両方が使えることを確認します。

### 手順A: ホバー+キー方式

1. 4行目にホバー
2. **Dキー**を押す
3. アクションが実行される

### 手順B: QuickPick方式

1. `myTestFunction` の上にカーソルを置く（ホバーなし）
2. **Ctrl+Shift+Space** を押す
3. QuickPickが表示される
4. ショートカットを選択

### 期待される結果

- ✅ 両方の方法が使える
- ✅ どちらも正常に動作する
- ✅ 互いに干渉しない

✅ **合格** / ❌ **不合格**

---

## 📊 テスト結果まとめ

| テスト | 内容 | 結果 |
|--------|------|------|
| 1 | 基本的なホバー+キー | ✅/❌ |
| 2 | キー入力でアクション実行 | ✅/❌ |
| 3 | 参照を表示（Rキー） | ✅/❌ |
| 4 | コメント追加（Cキー） | ✅/❌ |
| 5 | 変数でのテスト | ✅/❌ |
| 6 | クラスでのテスト | ✅/❌ |
| 7 | タイムアウトの確認 | ✅/❌ |
| 8 | 非ショートカットキー | ✅/❌ |
| 9 | QuickPickとの併用 | ✅/❌ |

**合格数:** ___ / 9

---

## 🎯 重要なポイント

### ✅ 成功のサイン

1. **ホバー情報が表示される**
   - 関数の1行上の行にホバーしたとき
   - ショートカット一覧が表示される

2. **ステータスバーに通知**
   ```
   👻 "myTestFunction" (function) - ホバー中
   ```

3. **キー入力が文字として入力されない**
   - Dキーを押しても「D」という文字が入力されない
   - アクションが即座に実行される

4. **2秒のタイムアウト**
   - マウスが離れても2秒間は有効
   - 2秒経過後は通常の入力に戻る

---

## 🐛 トラブルシューティング

### 問題1: ホバー情報が表示されない

**確認ポイント:**
- ✅ 関数の1行上の行にホバーしていますか？（関数名自体ではない）
- ✅ 拡張機能が有効になっていますか？（`Ctrl+Shift+G`で確認）
- ✅ コンパイルエラーはありませんか？（`npm run compile`）

### 問題2: キーを押しても何も起こらない

**確認ポイント:**
- ✅ ホバー情報が表示されていますか？
- ✅ ステータスバーに「ホバー中」と表示されていますか？
- ✅ 2秒以内にキーを押していますか？
- ✅ 正しいキー（D, R, H, N, P, C）を押していますか？

### 問題3: 文字が入力されてしまう

**可能性:**
- ホバー状態が正しく検出されていない
- `type`コマンドのインターセプトが機能していない

**確認方法:**
1. `Ctrl+Shift+I` で開発者ツールを開く
2. Consoleタブでエラーを確認
3. エラーメッセージをコピーして報告

### 問題4: ホバー情報が消えない

**対処法:**
- マウスを他の場所に移動すると消えます
- または2秒待つと自動的に無効になります

---

## 💡 使い方のコツ

### コツ1: ホバー位置

```javascript
3 | // コメント行        ← ここにホバー ✅
4 | function test() {   ← ここではない ❌
```

### コツ2: キー入力のタイミング

```
ホバー → ホバー情報表示 → すぐにキーを押す
                          ^^^^^^^^^^
                          0-2秒以内
```

### コツ3: よく使うショートカット

- **D**: 定義へジャンプ（最もよく使う）
- **R**: 参照を表示（2番目によく使う）
- **N**: 名前を変更
- **C**: コメント追加

### コツ4: QuickPickとの使い分け

- **ホバー+キー**: マウスで作業中のとき
- **QuickPick** (`Ctrl+Shift+Space`): キーボードのみで作業中のとき

---

## 🎉 テスト完了！

すべてのテストが合格したら、機能は正常に動作しています。

実際の開発で使ってみて、フィードバックをお願いします！

---

**テスト実施日:** _______________

**合格/不合格:** _______________

**コメント:** _______________





