# 👻 最終版 - テスト手順

## ✅ 実装完了

### 実装内容

1. ✅ 単語の直前に👻を配置
2. ✅ 厳密なフィルタリング（コメント・文字列・予約語除外）
3. ✅ ホバー範囲は👻アイコンのみ

---

## 🚀 クイックテスト（3分）

### ステップ1: 起動

```bash
npm run compile
code .
# F5キーで起動
# Ctrl+Shift+I で開発者ツール（Console タブ）
```

### ステップ2: 基本テスト

1. `test-samples/sample.js` を開く

2. 関数名をクリック:
```javascript
function myTestFunction() {
         ^^^^^^^^^^^^^ ← ここをクリック
```

3. **期待される表示:**
```javascript
function 👻 myTestFunction() {
         ^^
         ここに👻が1つだけ
```

4. **👻の上にマウスホバー**（単語ではなく👻に）

5. ホバー情報が表示される

6. **Rキー**を押す

7. **期待される結果:**
   - ✅ 参照パネルが開く
   - ✅ 「R」は入力されない
   - ✅ 👻は残る

---

## 🧪 詳細テスト

### テスト1: 👻の位置

#### 関数

```javascript
function 👻 myTestFunction() {
         ^^← ここに表示される ✅
```

#### 変数

```javascript
const 👻 myVariable = 42;
      ^^← ここに表示される ✅
```

#### クラス

```javascript
class 👻 MyClass {
      ^^← ここに表示される ✅
```

#### インデント付き

```javascript
function outer() {
    const 👻 innerVar = 1;
          ^^← ここに表示される ✅
}
```

✅ **合格** / ❌ **不合格**

---

### テスト2: コメント除外

#### コメント行

```javascript
// この myFunction をクリック
```

**期待される結果:**
- ✅ 👻は表示されない

**ログ:**
```
[Ghost] 🚫 除外: word="myFunction" (コメント/文字列/予約語)
[Ghost] 🚫 除外理由: コメント行
```

✅ **合格** / ❌ **不合格**

---

### テスト3: 文字列除外

#### ダブルクォート

```javascript
const str = "myFunction";
            ^^^^^^^^^^← クリック
```

**期待される結果:**
- ✅ 👻は表示されない

**ログ:**
```
[Ghost] 🚫 除外: word="myFunction" (コメント/文字列/予約語)
[Ghost] 🚫 除外理由: ダブルクォート文字列内
```

✅ **合格** / ❌ **不合格**

---

### テスト4: 予約語除外

#### if文

```javascript
if (test) { }
^^← クリック
```

**期待される結果:**
- ✅ 👻は表示されない

**ログ:**
```
[Ghost] 🚫 除外: word="if" (コメント/文字列/予約語)
[Ghost] 🚫 除外理由: 予約語
```

✅ **合格** / ❌ **不合格**

---

### テスト5: ホバー範囲（👻のみ）

1. 関数をクリック → 👻表示
2. **👻にホバー** → ガイド表示 ✅
3. **単語にホバー** → 何も起きない ✅

**ログ:**

👻にホバー:
```
[Ghost] 📍 位置情報: ホバー位置=9, 👻位置=9
[Ghost] ✅ 👻アイコンにホバー！
```

単語にホバー:
```
[Ghost] 📍 位置情報: ホバー位置=15, 👻位置=9
[Ghost] ⚪ ホバー: 👻アイコン外にホバー (👻範囲=[8-10])
```

✅ **合格** / ❌ **不合格**

---

### テスト6: キー入力が挿入されない

1. 関数をクリック → 👻表示
2. 👻にホバー → ガイド表示
3. **Dキー**を押す

**期待される結果:**
- ✅ 定義へジャンプ
- ✅ 「D」は入力されない

**ログ:**
```
[Ghost] ⌨️  キー入力: "D", active=true, word="myTestFunction"
[Ghost] 🚀 ショートカット実行: key="D", label="定義へジャンプ"
[Ghost] ✅ ショートカット実行完了 - undefined を返す（文字入力を完全にブロック）
```

✅ **合格** / ❌ **不合格**

---

### テスト7: 繰り返し使用

1. 関数をクリック
2. 👻にホバー → Rキー
3. 👻にホバー → Dキー
4. 👻にホバー → Hキー

**期待される結果:**
- ✅ 何度でも使える
- ✅ クリックし直す必要なし
- ✅ 👻は残る

✅ **合格** / ❌ **不合格**

---

## 📊 テスト結果

| テスト | 内容 | 結果 |
|--------|------|------|
| 1 | 👻の位置（単語の直前） | ✅/❌ |
| 2 | コメント除外 | ✅/❌ |
| 3 | 文字列除外 | ✅/❌ |
| 4 | 予約語除外 | ✅/❌ |
| 5 | ホバー範囲（👻のみ） | ✅/❌ |
| 6 | キー入力が挿入されない | ✅/❌ |
| 7 | 繰り返し使用できる | ✅/❌ |

**合格数:** ___ / 7

---

## 🎯 重要なポイント

### 1. 👻の位置は単語の直前

```javascript
function 👻 myTestFunction() {
         ^^
         functionより右
         単語のすぐ左隣
```

### 2. 除外されるもの

- コメント（`//`, `/*`, `*`）
- 文字列（`"..."`, `'...'`, `` `...` ``）
- 予約語（`if`, `for`, `while`, `return`, ...）

### 3. ホバー範囲

```javascript
function 👻 myTestFunction() {
         ^^
         👻の前後1文字のみ
```

---

## 🐛 トラブルシューティング

### 問題1: 👻が表示されない

**確認:**
- コメントや文字列ではないですか？
- ログに `🚫 除外` が出ていますか？

### 問題2: ホバー情報が表示されない

**確認:**
- 👻の上に正確にマウスがありますか？
- ログで `📍 位置情報: ホバー位置=?` を確認
- ホバー位置が👻範囲内（±1文字）ですか？

### 問題3: 👻の位置がずれている

**ログで確認:**
```
[Ghost] 🎨 👻を表示: position=? (単語の直前)
```

この位置が単語の開始位置と一致しているか確認してください。

---

## 🎉 成功のサイン

すべてのテストが合格なら：

- ✅ 👻が単語の直前に1つだけ表示される
- ✅ コメント・文字列・予約語では表示されない
- ✅ 👻にホバーでガイドが表示される
- ✅ 単語にホバーしても何も起きない
- ✅ キーが挿入されない
- ✅ 何度でも使える

---

**試してみて、結果とログを教えてください！** 😊







