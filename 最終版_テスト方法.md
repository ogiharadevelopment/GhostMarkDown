# 最終版 - テスト方法

## ✅ 修正内容

1. ✅ **ホバー検出の厳密化** - 👻にホバー中のみキーを受け付ける
2. ✅ **完全な多言語対応** - 英語/日本語自動切り替え

---

## 🚀 今すぐテスト

```bash
npm run compile
code .
# F5キーで起動
# Ctrl+Shift+I で開発者ツール（Console タブ）
```

---

## 🧪 テスト1: ホバー検出

### 1-1: 👻にホバー中（ショートカット発動） ✅

```
1. 関数をクリック → 👻表示
2. 👻にマウスホバー
3. Rキー押す
```

**期待される結果:**
- ✅ 参照パネルが開く
- ✅ 「R」は入力されない

**ログ:**
```
[Ghost] isHovering = true に設定
[Ghost] ⌨️  キー入力: "R", active=true, isHovering=true
[Ghost] 🚀 ショートカット実行
```

---

### 1-2: 👻にホバーしていない（文字入力） ✅

```
1. 関数をクリック → 👻表示
2. 👻から離れた場所にマウス
3. Rキー押す
```

**期待される結果:**
- ✅ 「R」が入力される
- ✅ ショートカットは実行されない

**ログ:**
```
[Ghost] ⌨️  キー入力: "R", active=true, isHovering=false
[Ghost] 🔵 キー入力: isHovering=false（👻にホバーしていない） - 通常の入力として処理
```

---

### 1-3: マウスリーブ後（文字入力） ✅

```
1. 関数をクリック → 👻表示
2. 👻にホバー → ガイド表示
3. マウスを離す（0.5秒待つ）
4. Rキー押す
```

**期待される結果:**
- ✅ 「R」が入力される

**ログ:**
```
[Ghost] ⏱️  ホバータイムアウト: isHovering = false に設定（マウスリーブ検出）
[Ghost] ⌨️  キー入力: "R", active=true, isHovering=false
[Ghost] 🔵 通常の入力として処理
```

---

## 🧪 テスト2: 多言語対応

### 2-1: 英語モード

VS Codeを英語モードにして確認:

**ホバー情報:**
```
👻 Ghost in the VSC

myTestFunction (function)  ← "function"
───────────────────────
Press key to execute shortcut:  ← 英語

• D: Go to Definition  ← 英語
• R: Show References  ← 英語
```

**ステータスバー:**
```
👻 "myTestFunction" (function) - Active  ← 英語
```

---

### 2-2: 日本語モード

VS Codeを日本語モードにして確認:

**ホバー情報:**
```
👻 Ghost in the VSC

myTestFunction (関数)  ← "関数"
───────────────────────
キーを押してショートカット実行:  ← 日本語

• D: 定義へジャンプ  ← 日本語
• R: 参照を表示  ← 日本語
```

**ステータスバー:**
```
👻 "myTestFunction" (関数) - ホバー中  ← 日本語
```

---

## 📊 テスト結果

| テスト | 内容 | 結果 |
|--------|------|------|
| 1-1 | 👻にホバー中にキー押す | ✅/❌ |
| 1-2 | 👻以外にホバー中にキー押す | ✅/❌ |
| 1-3 | マウスリーブ後にキー押す | ✅/❌ |
| 2-1 | 英語モードで表示 | ✅/❌ |
| 2-2 | 日本語モードで表示 | ✅/❌ |

**合格数:** ___ / 5

---

## 🎯 重要なポイント

### ポイント1: isHoveringフラグ

```
active=true, isHovering=true  → ショートカット実行 ✅
active=true, isHovering=false → 通常の文字入力 ✅
```

### ポイント2: マウスリーブの検出

```
👻にホバー → isHovering=true
↓ (0.5秒後)
isHovering=false （マウスが動かない場合）
```

### ポイント3: 言語の自動切り替え

```
vscode.env.language === 'ja' → 日本語メッセージ
vscode.env.language === 'en' → 英語メッセージ
その他 → 英語メッセージ（デフォルト）
```

---

## 🐛 トラブルシューティング

### 問題1: まだ👻以外でキーが反応する

**ログを確認:**
```
[Ghost] ⌨️  キー入力: "R", active=?, isHovering=?
                                          ↑
                                    ここがtrueになっていないか確認
```

### 問題2: 言語が切り替わらない

**確認:**
1. VS Codeの言語設定を確認
2. 拡張機能開発ホストを再起動
3. Console タブでロケールを確認: `vscode.env.language`

---

## 🎉 成功のサイン

すべてのテストが合格なら：

1. ✅ 👻にホバー中のみショートカット発動
2. ✅ 👻以外ではキーが通常入力される
3. ✅ 英語/日本語が自動切り替え
4. ✅ ホバー情報が多言語化
5. ✅ ステータスバーが多言語化

---

**試してみて、結果を教えてください！** 😊

ログの`isHovering`の値に注目してください。







