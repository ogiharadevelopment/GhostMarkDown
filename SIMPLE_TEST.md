# 修正版のテスト手順

## 🚀 準備（初回のみ）

```bash
npm install
npm run compile
```

## ✅ テスト開始

### 1. 拡張機能を起動

```bash
# VS Codeで開く
code .

# F5キーを押す
# → 新しいウィンドウ「[拡張機能開発ホスト]」が開きます
```

### 2. サンプルファイルを開く

拡張機能開発ホストのウィンドウで：

1. `Ctrl+O`（Macは`Cmd+O`）
2. `test-samples/sample.js` を選択
3. 開く

### 3. ゴーストマーカーのテスト

#### 3-1. カーソルを置く

```javascript
👇 ここにカーソルを置く
function myTestFunction() {
    console.log('Hello, Ghost in the VSC!');
}
```

`myTestFunction` の任意の文字の上をクリック。

#### 3-2. 確認

**期待される結果:**

```javascript
👻 function myTestFunction() {
   ^--- ここに👻が表示される
```

- ✅ 関数名の左側に 👻 マーカーが表示される
- ✅ 行全体が薄くハイライトされる
- ✅ 画面下のステータスバーに通知が表示される：
  ```
  👻 Ghost: "myTestFunction" でショートカットを使用できます (Ctrl+Shift+Space でガイド表示)
  ```

**表示されない場合:**
- `Ctrl+Shift+G` を押して有効/無効を切り替えてみる
- `Ctrl+Shift+I` で開発者ツールを開いてエラーを確認

---

### 4. ガイドを表示

#### 4-1. ショートカットキーを押す

カーソルが `myTestFunction` の上にある状態で：

```
Ctrl+Shift+Space
(Macは Cmd+Shift+Space)
```

#### 4-2. 確認

**期待される結果:**

画面中央上部にQuickPickが表示される：

```
┌─────────────────────────────────────────────┐
│ 👻 Ghost in the VSC                        │
│ > "myTestFunction" のショートカットを選択   │
├─────────────────────────────────────────────┤
│ ⌨ D  定義へジャンプ  (F12と同じ)          │
│ ⌨ R  参照を表示  (Shift+F12と同じ)        │
│ ⌨ H  呼び出し階層  (Shift+Alt+Hと同じ)    │
│ ⌨ N  名前を変更  (F2と同じ)               │
│ ⌨ P  定義をプレビュー  (Alt+F12と同じ)    │
│ ⌨ C  コメントを追加                        │
└─────────────────────────────────────────────┘
```

---

### 5. ショートカットを実行

#### 5-1. 項目を選択

QuickPickが表示されている状態で：

- **方法1:** 矢印キー ↓ で「⌨ R  参照を表示」を選択して **Enter**
- **方法2:** マウスで「⌨ R  参照を表示」をクリック

#### 5-2. 確認

**期待される結果:**

- ✅ 左側に「参照」パネルが開く
- ✅ `myTestFunction` の使用箇所が一覧表示される
- ✅ 通知が表示される：`✅ ショートカット実行: R (myTestFunction)`

---

### 6. その他のコンテキストでテスト

#### 6-1. 変数でテスト

```javascript
const myVariable = 42;
      ^^^^^^^^^^
      ここにカーソルを置く
```

1. `myVariable` にカーソルを置く
2. `Ctrl+Shift+Space` を押す

**期待される結果:**
```
コンテキスト: (variable)
ショートカット:
  ⌨ D  定義へジャンプ
  ⌨ R  参照を表示
  ⌨ N  名前を変更
  ⌨ T  型定義へジャンプ
```

#### 6-2. クラスでテスト

```javascript
class MyTestClass {
      ^^^^^^^^^^^^
      ここにカーソルを置く
```

1. `MyTestClass` にカーソルを置く
2. `Ctrl+Shift+Space` を押す

**期待される結果:**
```
コンテキスト: (class)
ショートカット:
  ⌨ D  定義へジャンプ
  ⌨ R  参照を表示
  ⌨ I  実装へジャンプ
  ⌨ N  名前を変更
  ⌨ M  メンバー一覧
```

---

### 7. コメント追加機能のテスト

#### 7-1. コメントを追加

1. `myTestFunction` にカーソルを置く
2. `Ctrl+Shift+Space` を押す
3. 「⌨ C  コメントを追加」を選択

#### 7-2. 確認

**期待される結果:**

関数の上にJSDocコメントが自動挿入される：

```javascript
/**
 * myTestFunction の説明
 */
function myTestFunction() {
    console.log('Hello, Ghost in the VSC!');
}
```

- ✅ コメントが自動挿入される
- ✅ カーソルが「説明」の部分に移動する
- ✅ そのまま説明文を入力できる

---

## 🎛️ 有効/無効の切り替え

### テスト

1. `Ctrl+Shift+G`（Macは`Cmd+Shift+G`）を押す
2. 通知を確認：「Ghost in the VSC: 無効」
3. ゴーストマーカーが消える

4. もう一度 `Ctrl+Shift+G` を押す
5. 通知を確認：「Ghost in the VSC: 有効」
6. ゴーストマーカーが再表示される

---

## ✅ テストチェックリスト

全てのテストを完了したらチェック：

- [ ] 1. 拡張機能が起動する
- [ ] 2. サンプルファイルが開ける
- [ ] 3. ゴーストマーカー（👻）が表示される
- [ ] 4. ステータスバーに通知が表示される
- [ ] 5. Ctrl+Shift+Space でガイドが表示される
- [ ] 6. QuickPickでショートカットが選択できる
- [ ] 7. 参照の表示が動作する
- [ ] 8. 変数で適切なコンテキストが表示される
- [ ] 9. クラスで適切なコンテキストが表示される
- [ ] 10. コメント追加機能が動作する
- [ ] 11. Ctrl+Shift+G で有効/無効を切り替えられる

---

## 🐛 トラブルシューティング

### 問題1: 👻マーカーが表示されない

**解決策:**

1. 拡張機能が有効か確認:
   ```
   Ctrl+Shift+G で切り替え
   ```

2. コンパイルエラーがないか確認:
   ```bash
   npm run compile
   ```

3. 拡張機能開発ホストを再起動:
   ```
   ウィンドウを閉じて、F5を再度押す
   ```

### 問題2: QuickPickが表示されない

**解決策:**

1. カーソルが関数名/変数名の上にあるか確認
2. 正しいキーを押しているか確認: `Ctrl+Shift+Space`
3. 開発者ツールでエラーを確認: `Ctrl+Shift+I`

### 問題3: エラーが表示される

**確認方法:**

1. `Ctrl+Shift+I` で開発者ツールを開く
2. Consoleタブでエラーメッセージを確認
3. エラーメッセージをコピーしてフィードバック

---

## 🎉 成功！

すべてのチェックリストが完了したら、拡張機能は正常に動作しています。

実際の開発で使ってみて、感想をお聞かせください！

---

## 📝 重要な変更点

元の構想から変更された点：

| 機能 | 元の構想 | 修正版 |
|------|---------|--------|
| ゴースト表示 | 1行上に透明オーバーレイ + 四隅に赤い点 | エディタ内に 👻 マーカー |
| ガイド表示 | マウスホバーで自動表示 | Ctrl+Shift+Space で表示 |
| UI | カスタムWebview | VS Code標準のQuickPick |
| 操作方法 | マウス中心 | キーボード中心 |

**理由:** VS Code APIの制限により、エディタ上に透明なオーバーレイを表示することは技術的に不可能なため、実現可能な方法に変更しました。

---

**質問や問題がありましたら、お気軽にお知らせください！**





